package com.currency.currencyconversionservice.service;

import java.util.HashMap;
import java.util.Map;

import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import com.currency.currencyconversionservice.entity.CurrencyConverted;
import com.currency.currencyconversionservice.entity.CurrencyRate;


@Service
public class CurrencyServiceClass implements CurrencyService {

	@Override
	public CurrencyConverted getConversionRate(String from, String to, Integer quantity) {
		
		Map<String, String> uriVariables = new HashMap<String,String>();
		uriVariables.put("from", from);
		uriVariables.put("to",to);

		// url for currency rate of 1 EUR to other currencies
		String url="http://data.fixer.io/api/latest?access_key=7fbb297eabc883c452ed9f45a5825d4b";
		ResponseEntity<CurrencyRate> currencyRate = new RestTemplate().getForEntity(url, CurrencyRate.class);		
		
		CurrencyConverted converted = new CurrencyConverted(currencyRate.getBody().getBase(),
																to,
																currencyRate.getBody().getRates().get("INR"));
		
		return converted;
	}

}